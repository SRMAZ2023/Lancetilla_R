USE MASTER 
GO
USE db_Lancetilla
GO

--************************************************************************************************************************************************************--

--**************************************************************INSERT DE ACCESO******************************************************************************--

--*************************************************************TABLA DE USUARIOS******************************************************************************--
CREATE OR ALTER VIEW acce.VW_tbUsuarios
AS 

SELECT T1.usua_Id, 
	   T1.usua_NombreUsuario, 
	   T1.empl_Id, 
	   empl_Nombre + ' ' + empl_Apellido AS empl_Nombre,
	   T1.usua_Contraseña,
	   T3.role_Id, 
	   role_Descripcion,
	   T1.usua_Admin, 
	   CASE T1.usua_Admin WHEN 1 THEN 'Sí'
	   ELSE 'No' END AS usua_EsAdmin,
	   usua_UserCreaNombre = T4.usua_NombreUsuario,
	   T1.usua_UserCreacion, 
	   T1.usua_FechaCreacion, 
	   usua_UserModiNombre = T5.usua_NombreUsuario,
	   T1.usua_UserModificacion, 
	   T1.usua_FechaModificacion, 
	   T1.usua_Estado 
	   FROM acce.tbUsuarios T1
	   INNER JOIN mant.tbEmpleados T2
	   ON T1.empl_Id = T2.empl_Id
	   INNER JOIN acce.tbRoles T3
	   ON T1.role_Id = T3.role_Id
	   INNER JOIN acce.tbUsuarios T4
	   ON T1.usua_Id = T4.usua_Id
	   LEFT JOIN acce.tbUsuarios T5
	   ON T1.usua_Id = T5.usua_Id
GO
--************************************************************/TABLA DE USUARIOS******************************************************************************--

----------------------------------------------------------------------------------------------------------------------------------------------------------------

--**************************************************************TABLA DE ROLES********************************************************************************--
--*************************************************************/TABLA DE ROLES********************************************************************************--

----------------------------------------------------------------------------------------------------------------------------------------------------------------

--************************************************************TABLA DE PANTALLAS******************************************************************************--
--***********************************************************/TABLA DE PANTALLAS******************************************************************************--

----------------------------------------------------------------------------------------------------------------------------------------------------------------

--*******************************************************TABLA DE ROLES POR PANTALLA**************************************************************************--
--******************************************************/TABLA DE ROLES POR PANTALLA**************************************************************************--

----------------------------------------------------------------------------------------------------------------------------------------------------------------

--*************************************************************/INSERT DE ACCESO******************************************************************************--


----------------------------------------------------------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------------------------------------------------------------


--***********************************************************INSERT DE MANTENIMIENTO**************************************************************************--

--***********************************************************TABLA DE DEPARTAMENTOS***************************************************************************--
CREATE OR ALTER VIEW mant.VW_tbDepartamentos
AS

SELECT  dept_Id, 
		dept_Descripcion, 
		(SELECT empl_Nombre+' '+empl_ApellIdo FROM mant.tbEmpleados 
		WHERE empl_Id IN (SELECT empl_Id FROM acce.tbUsuarios WHERE [usua_Id] = dept_UserCreacion)) AS usua_UserCreaNombre,
		dept_UserCreacion, 
		dept_FechaCreacion, 
	   (SELECT empl_Nombre+' '+empl_ApellIdo FROM mant.tbEmpleados 
		WHERE empl_Id IN (SELECT empl_Id FROM acce.tbUsuarios WHERE [usua_Id] = dept_UserModificacion)) AS usua_UserModiNombre,
		dept_UserModificacion, 
		dept_FechaModificacion, 
		dept_Estado 
		FROM mant.tbDepartamentos
GO
--**********************************************************/TABLA DE DEPARTAMENTOS***************************************************************************--

----------------------------------------------------------------------------------------------------------------------------------------------------------------

--*************************************************************TABLA DE MUNICIPIOS****************************************************************************--
CREATE OR ALTER VIEW mant.VW_tbMunicipios
AS

SELECT muni_Id, 
	   muni_Descripcion, 
	   T1.dept_Id, 
	   dept_Descripcion,
	   (SELECT empl_Nombre+' '+empl_ApellIdo FROM mant.tbEmpleados 
	   WHERE empl_Id IN (SELECT empl_Id FROM acce.tbUsuarios WHERE [usua_Id] = muni_UserCreacion)) AS usua_UserCreaNombre,
	   muni_UserCreacion, 
	   muni_FechaCreacion, 
	   (SELECT empl_Nombre+' '+empl_ApellIdo FROM mant.tbEmpleados 
	   WHERE empl_Id IN (SELECT empl_Id FROM acce.tbUsuarios WHERE [usua_Id] = muni_UserModificacion)) AS usua_UserModiNombre,
	   muni_UserModificacion, 
	   muni_FechaModificacion, 
	   muni_Estado
       FROM mant.tbMunicipios T1
	   INNER JOIN mant.tbDepartamentos T2
	   ON T1.dept_Id = T2.dept_Id
GO
--*************************************************************/TABLA DE MUNICIPIOS***************************************************************************--

----------------------------------------------------------------------------------------------------------------------------------------------------------------

--***********************************************************TABLA DE ESTADOS CIVILES*************************************************************************--
CREATE OR ALTER VIEW mant.VW_tbEstadosCiviles
AS 

SELECT  estc_Id, 
		estc_Descripcion, 
	    (SELECT empl_Nombre+' '+empl_ApellIdo FROM mant.tbEmpleados 
	    WHERE empl_Id IN (SELECT empl_Id FROM acce.tbUsuarios WHERE [usua_Id] = estc_UserCreacion)) AS usua_UserCreaNombre,
		estc_UserCreacion,
		estc_FechaCreacion,
	    (SELECT empl_Nombre+' '+empl_ApellIdo FROM mant.tbEmpleados 
	    WHERE empl_Id IN (SELECT empl_Id FROM acce.tbUsuarios WHERE [usua_Id] = estc_UserModificacion)) AS usua_UserModiNombre,
		estc_UserModificacion,
		estc_FechaModificacion,
		estc_Estado 
		FROM mant.tbEstadosCiviles

GO
--**********************************************************/TABLA DE ESTADOS CIVILES*************************************************************************--

----------------------------------------------------------------------------------------------------------------------------------------------------------------

--****************************************************************TABLA DE CARGOS*****************************************************************************--
CREATE OR ALTER VIEW mant.VW_tbCargos
AS 

SELECT carg_Id, 
       carg_Descripcion,
	   (SELECT empl_Nombre+' '+empl_ApellIdo FROM mant.tbEmpleados 
	   WHERE empl_Id IN (SELECT empl_Id FROM acce.tbUsuarios WHERE [usua_Id] = carg_UserCreacion)) AS usua_UserCreaNombre,
	   carg_UserCreacion, 
	   carg_FechaCreacion,
	   (SELECT empl_Nombre+' '+empl_ApellIdo FROM mant.tbEmpleados 
	   WHERE empl_Id IN (SELECT empl_Id FROM acce.tbUsuarios WHERE [usua_Id] = carg_UserModificacion)) AS usua_UserModiNombre,
	   carg_UserModificacion,
	   carg_FechaModificacion,
	   carg_Estado 
	   FROM mant.tbCargos
GO
--***************************************************************/TABLA DE CARGOS*****************************************************************************--

----------------------------------------------------------------------------------------------------------------------------------------------------------------

--**************************************************************TABLA DE EMPLEADOS****************************************************************************--
CREATE OR ALTER VIEW mant.VW_tbEmpleados
AS 

SELECT empl_Id,
       empl_Nombre + ' '+ empl_Apellido AS empl_Nombres, 
	   empl_Identidad,
	   empl_FechaNacimiento,
	   empl_Direccion, 
	   empl_Sexo,
	   empl_Telefono,
	   estc_Id, 
	   carg_Id, 
	   muni_Id,
	   (SELECT empl_Nombre+' '+empl_ApellIdo FROM mant.tbEmpleados 
	   WHERE empl_Id IN (SELECT empl_Id FROM acce.tbUsuarios WHERE [usua_Id] = empl_UserCreacion)) AS usua_UserCreaNombre,
	   empl_UserCreacion,
	   empl_FechaCreacion, 
	   (SELECT empl_Nombre+' '+empl_ApellIdo FROM mant.tbEmpleados 
	   WHERE empl_Id IN (SELECT empl_Id FROM acce.tbUsuarios WHERE [usua_Id] = empl_UserModificacion)) AS usua_UserModiNombre,
	   empl_UserModificacion, 
	   empl_FechaModificacion, 
	   empl_Estado 
	   FROM mant.tbEmpleados T1
	   INNER JOIN mant.tbEstadosCiviles T2
	   ON T1.estc_Id = T2.estc_Id
	   INNER JOIN mant.tbCargos T3


GO
--*************************************************************/TABLA DE EMPLEADOS****************************************************************************--

----------------------------------------------------------------------------------------------------------------------------------------------------------------

--*************************************************************/TABLA DE EMPLEADOS****************************************************************************--
--*************************************************************/TABLA DE EMPLEADOS****************************************************************************--

--**********************************************************/INSERT DE MANTENIMIENTO**************************************************************************--


----------------------------------------------------------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------------------------------------------------------------


--***************************************************************INSERT DE ZOOLOGICO**************************************************************************--

--*****************************************************************TABLA DE ÁREAS*****************************************************************************--
--****************************************************************/TABLA DE ÁREAS*****************************************************************************--

----------------------------------------------------------------------------------------------------------------------------------------------------------------

--****************************************************************TABLA DE ESPECIES**************************************************************************--
--***************************************************************/TABLA DE ESPECIES**************************************************************************--

----------------------------------------------------------------------------------------------------------------------------------------------------------------

--**************************************************************TABLA DE ALIMENTACIÓN************************************************************************--
--*************************************************************/TABLA DE ALIMENTACIÓN************************************************************************--

----------------------------------------------------------------------------------------------------------------------------------------------------------------

--****************************************************************TABLA DE ANIMALES**************************************************************************--
--***************************************************************/TABLA DE ANIMALES**************************************************************************--

----------------------------------------------------------------------------------------------------------------------------------------------------------------

--*********************************************************TABLA DE TIPOS MANTENIMIENTO**********************************************************************--
--*********************************************************/TABLA DE TIPOS MANTENIMIENTO**********************************************************************--

----------------------------------------------------------------------------------------------------------------------------------------------------------------

--*************************************************************TABLA DE MANTENIMIENTO*************************************************************************--
--************************************************************/TABLA DE MANTENIMIENTO*************************************************************************--

--**************************************************************/INSERT DE ZOOLOGICO**************************************************************************--


----------------------------------------------------------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------------------------------------------------------------


--****************************************************************INSERT DE BOTÁNICA**************************************************************************--

--*************************************************************TABLA DE AREAS BOTÁNICAS***********************************************************************--
--************************************************************/TABLA DE AREAS BOTÁNICAS***********************************************************************--

----------------------------------------------------------------------------------------------------------------------------------------------------------------

--*****************************************************************TABLA DE CUIDADOS***************************************************************************--
--****************************************************************/TABLA DE CUIDADOS***************************************************************************--

----------------------------------------------------------------------------------------------------------------------------------------------------------------

--*****************************************************************TABLA DE PLANTAS****************************************************************************--
--****************************************************************/TABLA DE PLANTAS***************************************************************************--

--***************************************************************/MÓDULO DE BOTÁNICA**************************************************************************--


----------------------------------------------------------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------------------------------------------------------------


--***************************************************************INSERT DE FACTURACIÓN************************************************************************--

--*****************************************************************TABLA DE TICKETS***************************************************************************--
--****************************************************************/TABLA DE TICKETS***************************************************************************--

----------------------------------------------------------------------------------------------------------------------------------------------------------------

--*************************************************************TABLA DE MÉTODOS DE PAGO***********************************************************************--
--************************************************************/TABLA DE MÉTODOS DE PAGO***********************************************************************--

----------------------------------------------------------------------------------------------------------------------------------------------------------------

--****************************************************************TABLA DE FACTURAS***************************************************************************--
--***************************************************************/TABLA DE FACTURAS***************************************************************************--

----------------------------------------------------------------------------------------------------------------------------------------------------------------

--***********************************************************TABLA DE FACTURAS DETALLE************************************************************************--
--**********************************************************/TABLA DE FACTURAS DETALLE************************************************************************--

--**************************************************************/INSERT DE FACTURACIÓN************************************************************************--

--************************************************************************************************************************************************************--